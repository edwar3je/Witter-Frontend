# Witter (Frontend)

Link: https://witter-frontend.onrender.com

ERD (for API): https://lucid.app/lucidchart/d6c901d2-60ee-4888-9f9d-115dc716c04a/edit?viewport_loc=-487%2C-1423%2C2518%2C1466%2C0_0&invitationId=inv_f8429b10-abaa-4e28-81ed-537d92c2230f

test change 2

## Description:

Witter is a Twitter clone that allows users to create weets, follow other accounts and reweet, favorite and/or tab existing weets.

## Features:

Witter allows users to:
  - Create an account.
  - Edit/Delete their account.
  - Create weets.
  - Edit/Delete their weets.
  - Follow/Unfollow other accounts.
  - Reweet/Unreweet a weet.
  - Favorite/Unfavorite a weet.
  - Tab/Untab a weet.

The goal of the application is to create a simple Twitter clone by building a custom API using Node.js (backend) along with an app using React (frontend). The other goal behind the application was to create a frontend application that does not require many page refreshes to access essential features (e.g. favoriting, loading weets, etc.).

Most of the routes within the application can only be accessed if the current user has a valid json web token (JWT) generated by the external API. This web token contains the user's profile information and is used to indicate if the user is signed in. The token is saved in both a 'token' state on the React app along with localStorage to ensure the user stays signed in even after exiting the app.

Each form on the app contains a custom frontend 'error handling' that validates data prior to sending the data off to sensitive routes. While some of the forms (e.g. log-in/authentication) contain validation on the frontend, other forms (e.g. sign up, edit profile) send data to 'validation routes' on the external API. If the data is found to be valid, the data is sent to the 'official' route on the external API. Otherwise, any error messages generated by the validation process will be used to display error messages on the associated input(s) on the frontend. For more information on how validation is handled for each form, see 'Routes' further below.

Users are able to reweet, favorite and/or tab existing weets in real time (as well as the inverse actions). Each weet will contain stats on how many times the weet has been reweeted, favorited and tabbed. Users can also follow (or unfollow) other accounts either directly from the account's profile page or via a 'user card'. Following an account allows the current user the ability to view the accounts weets on their personal feed.

## User Flow:

Most users will access the site first through the home page. If a user is not signed in (or has not signed in), the home page will display two buttons indicating that the user can either create a new account or log into an existing account. Successfully registering a new account or authenticating credentials will result in the API returning a JWT that contains the user's profile information. This token will then be decrypted to obtain the user's profile information and save it to the 'user' state. The token will also be stored within the 'token' state and both the token and user information are stored in localStorage to ensure the user stays signed in upon page refresh.

Once signed in, the navbar on the website will change to display a few options: 'Post Weet', 'My Feed', 'Search Users', '{user} Profile' and 'Log Out'. Each of the options displayed (save for log out) leads to a different route that can only be accessed if the user is currently signed in ('token' state is either true, or 'token' is stored in localStorage). Since sign-in status is dictated by the presence of the token in state and localStorage, the log-out option removes 'token' and 'user' from both the React app's state and localStorage.

'Post Weet' directs users to a form that allows users to create new weets. The form will not allow users to send weets that consist of either just empty spaces, begin with an empty space or exceed the character limit of 250 characters. Attempting to do so will bring up relevant error messages that can be removed via clicking. If the weet written meets the criteria, the weet will be created on the backend and the user will be redirected to their home page.

'My Feed' directs users to a page that displays every weet written by the user and accounts the user follows from newest to oldest. Each weet that is displayed will provide several pieces of information: the author of the weet (username, handle and profile picture), the text of the weet, buttons to reweet, favorite or tab the weet (or the inverse if either has already been done), statistics on how often the weet has been reweeted, favorited or tabbed, an edit button (only displayed if the weet is written by the user) and a link to a route that displays the weet by itself. 

Since weets can either appear in groups or individually, there are two different formats for how weets are displayed: 'group' or 'individual'. Group weets contain all the information described above and appear in routes where multiple weets are shown (or expected to be shown) together. Individual weets contain most of the information described above with slight changes in how the information is displayed. Unlike group weets, individual weets do not contain a link to a route that displays the weet by itself. This is because individual weets are only displayed within their given route (based on the id of the weet provided in the url).

If a user clicks the edit button of a weet, it will direct the user to a form that displays an input containing the current text of the given weet. Similar to the post weet form, users are not allowed to edit a weet to contain only blank spaces, start with a blank space and/or exceed the character limit of 250 characters. If the data submitted is valid, the text of the weet will be sent to the API and the user will be redirected to a route that displays the individual weet. A user can also choose to delete their weet by clicking an initial delete button followed by a further prompt. If a user attempts to edit or delete a weet that they did not create, the user will be redirected to the home page.

'Search Users' directs users to a form containing a search bar that allows users to look up accounts by username. Once submitted, the API will attempt to find accounts containing usernames that match the username that do not rely on case sensitivity. If the API call returns accounts, the results will be displayed as user cards that contain the following pieces of information: the account's profile picture, the account's username, the account's handle, a button that allows users to follow (or unfollow) the account and a link to the account's profile page. Following/unfollowing an account is done in real time and does not require any page refreshes.

'{user} Profile' directs users to their own profile page, which contains a slew of information. Each profile page displays a user's viewable profile information (username, handle, user description, profile picture and banner picture), an edit profile button (only availabe if the profile page is for the current user), a follow/unfollow button (only available if the profile page is not for the current user) and a set of buttons that changes information displayed in the bottom portion. The bottom portion can display up to six different types of information without the need for a page refresh:
 - Weets written by the account (Weets).
 - Weets reweeted by the account (Reweets).
 - Weets favorited by the account (Favorites).
 - Weets tabbed by the account (only available if the profile page is for the current user; Tabs).
 - Accounts that follow the account (Followers).
 - Account the account is currently following (Following).

If a user clicks on the 'Edit Profile' button, the user will be directed to a form that contains the user's existing profile information in several inputs. The user can then edit any input containing information they would like to change (except for the user's handle, as this is required for identifying each user). The only field that does not need to be filled out is the 'new password' field, as this is only required if the user wishes to change their password. Once a user is pleased with the changes made to their profile, they must enter their current password before submitting the form. Submitting invalid data (or not providing the correct password) will result in error messages being displayed under the relevant fields containing invalid data. Submitting valid information will result in the data being sent to the API (this generates a new token that is saved to both state and localStorage) and the user being redirected to their profile page.

Users can also choose to delete their account by clicking the 'Delete my account' button followed by another prompt stating 'Yes, please delete my account'. Doing so will send a request to the API to delete the user's account from the backend, remove 'token' and 'user' from state and localStorage, and redirect the user to the home page. Users that attempt to edit another account's profile information or delete another account will be redirected to the home page.

Finally, if a user attempts to access a route that is not defined by the React app, the user will be redirected to a page indicating that the url does not exist.

## Routes:

### `/`

This is the route for the home page, and the content rendered on the page will change depending on the user's sign-in status. The sign-in status depends on whether the 'token' and 'user' state in the central App component contain any information. If the relevant states (or their counterparts in localStorage) contain information, the user will be greeted with a message. If the user is not signed in, the page will display two buttons that lead the user to either a page that allows them to create a new account, or a page that allows the user to sign into an existing account. This page also serves as a place to redirect users that attempt to access routes without proper authorization.

### `/account/sign-up`

This is the route that allows users to create a new account. The route renders a form containing inputs requiring users to provide a handle, username, password and email address. When data is submitted, a validation sequence begins where the data is sent to a validation route on the external API. If the result of the API call finds that the data is invalid, error messages will appear under the relevant inputs that can be clicked away. If the result of the API call finds that the data is valid, the data is sent to the official registration route on the external API, which will cause the API to produce a token. This token is then decrypted and the token and decrypted content are saved to the 'token' and 'user' states respectively (as well as localStorage). Finally, the user is redirected back to the home page and is officially deemed 'signed in'.

For data submitted to be considered valid, data in each input must meet the following checks:
  - handle:
    - must be between 8 - 20 characters long
    - must be unique
    - must match regular expression (can only contain lowercase letters, uppercase letters and numbers)
  - username:
    - must be between 8 - 20 characters long
    - must match regular expression (cannot consist of just empty spaces, nor start with an empty space)
  - password:
    - must be between 8 - 20 characters long
    - must match regular expression (must have 1 capital letter, 1 lowercase letter, 1 number and 1 special character with no blank spaces)
  - email: 
    - must be unique
    - must match regular expression (must contain an @ symbol and end with either .com, .edu or .net)

### `/account/log-in`

This is the route that allows users to sign into an existing account. The route renders a form containing inputs requiring users to provide a handle and password. Once the form is submitted, the data is sent to an authentication route on the backend that either returns a token or an error. If the route returns an error, an error message will display under the password input that the user can remove via clicking. If the route returns a token, the token will be decrypted and the token and decrypted content will be stored in the 'token' and 'user' states of the App component (both sets of information will also be stored in localStorage). Additionally, the user will be redirected to the home page and officially deemed 'signed in.'

### `/profile/:handle` (token required)

This route allows users to view the profile page for an account based on the handle provided in the url. If the account belongs to the user, the page will display an option allowing the user to edit their profile (otherwise, the page will display a button allowing the user to follow or unfollow the account). Regardless of who owns the account, each profile page will contain the account's viewable profile information and five to six buttons that change the information displayed for the given account. The information displayed include:
  - Weets published by the account (Weets).
  - Weets reweeted by the account (Reweets).
  - Weets favorited by the account (Favorites).
  - Weets tabbed by the account (only available if profile page belongs to user; Tabs).
  - Accounts that follow the account (Followers).
  - Accounts the account is currently following (Following).

If a user attempts to access a profile for an account that does not exist, the user will be redirected to the 'Not Found' page. If a user attempts to access the route while not signed in, the user will be redirected to the home page.

### `/profile/:handle/edit` (token required)

This route allows users to edit their profile information or delete their account. The route renders a form that contains inputs matching each part of the user's profile information (username, email, user description, profile picture and banner picture). The user can also choose to change their password, however it is not necessary unless the user enters information inside the 'New Password' input. Regardless of what the user changes, if the user wishes to finalize their changes, they must provide their current password at form submission.

Submitting the form causes a validation sequence to begin whereby the data is sent to a validation route on the external API. If the result of the API call finds that the data is invalid, error messages will pop up under the relevant inputs (these can be removed by the user via clicking). If the result of the API call finds that the data is valid, the data will be sent to a route on the external API that edits the profile and produces a new token that is saved to the relevant states and localStorage (the user is also redirected to their profile page).

For the data submitted to be considered valid, each piece of data must pass the following checks:
  - username:
    - must be between 8 - 20 characters long
    - must match regular expression (can only contain lowercase letters, uppercase letters and numbers)
  - current password:
    - must pass authentication check
  - new password (if submitted):
    - must be between 8 - 20 characters long
    - must be different from current password
    - must match regular expression (must have 1 capital letter, 1 lowercase letter, 1 number and 1 special character with no blank spaces)
  - email:
    - must be unique or match current email registered to account
    - must match regular expression (must contain an @ symbol and end with either .com, .edu or .net)
  - user description:
    - must be less than or equal to 250 characters in length
    - must match regular expression (cannot consist of just blank spaces nor start with one)
  - profile picture:
    - must match regular expression (url provided must contain either 'http' or 'https' as a protocol and contain either 'jpg', 'jpeg' or 'png' as a file extension)
  - banner picture:
    - must match regular expression (url provided must contain either 'http' or 'https' as a protocol and contain either 'jpg', 'jpeg' or 'png' as a file extension)

Users can delete their account by clicking a button labeled 'Delete my account' followed by another button labeled 'Yes, please delete my account'. Doing so will send a request to the external API that deletes the account from the backend, logs the user out (removes information from state and localStorage) and redirects the user to the home page.

If a user attempts to edit or delete another user's account, the user will be redirected to the home page. If the user attempts to edit an account while not signed in, the user will be redirected to the home page.

### `/users/` (token required)

This route allows users to search for other accounts by username. The route contains a form with an input where users can enter a string in a search bar input. When the form is submitted a request is sent to the external API that retrieves information on all users containing a username that matches the string provided that is case insensitive. All results will appear as user cards below the form which allow the user access the account's profile page and/or follow/unfollow the account.

If a user attempts to access the route while not signed in, the user will be redirected to the home page.

### `/weets/` (token required)

This route allows users to view their own feed. A feed consists of all weets published by a user and accounts the user currently follows from newest to oldest. As with any route containing weets, each weet can be reweeted, favorited or tabbed by the user.

If a user attempts to access the route while not signed in, the user will be redirected to the home page.

### `/weets/create` (token required)

This route allows users to post their own weets. The route contains a form with a single input where users can enter their weet. If a user submits a weet that either only contains blank spaces, starts with a blank space, or exceeds the character limit of 250 characters, one or more relevant error messages will pop up (the error messages can be clicked away). If the user submits a valid weet, the data will be sent to external API and the user will be redirected to their profile page.

If a user attempts to access the route while not signed in, the user will be redirected to the home page.

### `/weets/:id` (token required)

This route allows users to view an individual weet based on the id provided in the url. The route contains an 'individual' view of a weet, which contains the same information and functionality as a 'group' weet except that the individual view lacks a link to the weet itself. If the id provided does not match any weet stored on the external API, the user will be redirected to the 'Not Found' page.

If a user attempts to access the route while not signed in, the user will be redirected to the home page.

### `/weets/:id/edit` (token required)

This route allows users to either edit or delete a weet that they have published, based on the id provided in the url. The route contains a form with a single input filled with the text of the original weet. If the user attempts to submit edited text that either contains just blank spaces, starts with a blank space, or exceeds the 250 character limit, one or more relevant error messages will pop up (the error messages can be clicked away). If the user submits valid edited text, the data will be sent to the external API, and the user will be redirected to a route that displays the edited weet.

A user can also choose to delete their weet by clicking the 'Delete my weet' button, followed by clicking 'Yes, please delete my weet'. Doing so will send a request to the external API that deletes the weet from the backend and redirects the user to their profile page.

If the id provided does not match any weet stored on the external API, the user will be redirected to the 'Not Found' page. If a user attempts to access the route for a weet they did not publish, the user will be redirected to the home page. Finally, if a user attempts to access the route while not signed in, they will be redirected to the home page.

## External API:

Link: https://witter-backend-m74t.onrender.com

To aid in data retrieval and storage, the frontend of Witter uses a custom API built using Node.js. The main reason for why the API was custom built was to ensure new features could be added at will to the API depending on the needs of the application. For instance, validation routes were added to the API later in development to assist with frontend error-handling on forms containing sensitive data.

To ensure protection of sensitive data, most routes in the API require a json webtoken (JWT) to be sent that originates from the API (provided by the registration and authentication routes respectively). Additionally, other routes that apply to specific accounts (such as editing a weet or deleting an accout) require the token to contain information that matches the account's owner. This token is also used on the frontend to indicate that the user is signed in and provide proper authorization.

The API serves a few general goals:
 - Register new users (produces a token)
 - Authenticate credentials/log-in (produces a token)
 - Validate complicated form data
 - Retrieve information on weets, reweets, favorites and tabs
 - Retrieve information on users
 - Allow users to follow/unfollow users
 - Allow users to create/edit/delete weets
 - Allow users to reweet, favorite and/or tab weets (or the inverse of each)
 - Allow users to edit their profile or delete their account

For further information on how the external API functions, please see the README.md file for Witter Backend at https://github.com/edwar3je/Witter-Backend

## Tools Used:

 - create react app (CRA):
   - This tool was used to help set up the React application by installing several dependencies (including Babel) and creating a framework to work off.
 - jwt-decode:
   - A tool that provides a means of decoding json web tokens produced by the external API.
 - react:
   - Provides access to React hooks such as useState and useEffect.
 - react-router-dom:
   - Provides several methods, hooks and components that allow for true client-side routing (e.g. BrowserRouter, Routes, Route, Link, etc.).
 - uuid:
   - A tool that generates random strings. Used to create unique strings for key prop in child components.

## How to Set Up:

Note: To properly run the application, you must first install and run the backend of Witter inside your terminal (please see 'How to Set Up' in Witter Backend README.md).

Assuming you have the application folder installed on your computer, use your preferred terminal to access the directory. Once inside the directory, install all dependencies using the command 'npm install' (if you do not have 'npm' already installed in your terminal, please do so). Once the dependencies have been installed, open the directory containing the application in your preferred code editor and click on the file titled 'package.json'. Scroll down to the "scripts" key and check the port number listed next to the "start" key. If the port number is not specified in the value of the "start" key, please add "PORT=" followed by your preferred port number (I recommend 3001; 3000 is the default port number for Witter Backend).

Once you have configured your package.json file, move back to your terminal and enter the command 'npm start' while inside the directory containing your application. This will initiate a 'start' sequence which allows React to render the application inside a browser. Please note that the starting sequence may take upwards of a minute-and-a-half to start rendering the application in a browser. If you encounter any errors concerning missing data while rendering the app, or an issue with the port number, check if the backend is running and (if so) which port it is running on (the backend should not be running on the same port as the frontend).